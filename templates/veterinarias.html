{% extends 'partials/base.html' %}
{% load static %}


{% block css %}

<link href="{% static 'plugins/datatable/css/dataTables.bootstrap4.min.css' %}" rel="stylesheet" type="text/css">
<link href="{% static 'plugins/datatable/css/buttons.bootstrap4.min.css' %}" rel="stylesheet" type="text/css">


{% endblock css %}
{% block content %}

<div id="app">
    <div class="row">
        <div class="col-12 col-lg-8 col-md-12">
            <div id="map" style="height: 550px; width: 750px;"></div>
        </div>
        <div class="col-12 col-lg-4 col-md-12">
            <div class="card radius-15" id="suggestions">
                <div class="card-body">
                    <!-- Contenido de sugerencias -->
                    <h5>Veterinarias más Populares</h5>
                    <br>
                    <div class="card radius-15 bg-login-color">
                        <div class="card-body">
                            <div class="d-flex align-items-center gap-2">
                                <div class="">
                                    <h5 class="mb-0">Veterinaria 1</h5>
                                    <div class="list-inline contacts-social mt-2"> <a href="javascript:;"
                                            class="list-inline-item text-facebook"><i class="bx bxl-facebook"></i></a>
                                        <a href="javascript:;" class="list-inline-item"><i class="bx bxs-phone"></i></a>
                                        <a href="javascript:;" class="list-inline-item text-instagram"><i
                                                class="bx bxl-instagram"></i></a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="card radius-15 bg-login-color">
                        <div class="card-body">
                            <div class="d-flex align-items-center gap-2">
                                <div class="">
                                    <h5 class="mb-0">Veterinaria 2</h5>
                                    <div class="list-inline contacts-social mt-2"> <a href="javascript:;"
                                            class="list-inline-item text-facebook"><i class="bx bxl-facebook"></i></a>
                                        <a href="javascript:;" class="list-inline-item"><i class="bx bxs-phone"></i></a>
                                        <a href="javascript:;" class="list-inline-item text-instagram"><i
                                                class="bx bxl-instagram"></i></a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="card radius-15 bg-login-color">
                        <div class="card-body">
                            <div class="d-flex align-items-center gap-2">
                                <div class="">
                                    <h5 class="mb-0">Veterinaria 3</h5>
                                    <div class="list-inline contacts-social mt-2"> <a href="javascript:;"
                                            class="list-inline-item text-facebook"><i class="bx bxl-facebook"></i></a>
                                        <a href="javascript:;" class="list-inline-item"><i class="bx bxs-phone"></i></a>
                                        <a href="javascript:;" class="list-inline-item text-instagram"><i
                                                class="bx bxl-instagram"></i></a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="card radius-15 bg-login-color">
                        <div class="card-body">
                            <div class="d-flex align-items-center gap-2">
                                <div class="">
                                    <h5 class="mb-0">Veterinaria 4</h5>
                                    <div class="list-inline contacts-social mt-2"> <a href="javascript:;"
                                            class="list-inline-item text-facebook"><i class="bx bxl-facebook"></i></a>
                                        <a href="javascript:;" class="list-inline-item"><i class="bx bxs-phone"></i></a>
                                        <a href="javascript:;" class="list-inline-item text-instagram"><i
                                                class="bx bxl-instagram"></i></a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>


{% endblock content %}


{% block js %}

<!-- <script>
    function initMap() {
        // Usa la geolocalización para obtener la ubicación del usuario
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(function (position) {
                var userLocation = {
                    lat: position.coords.latitude,
                    lng: position.coords.longitude
                };

                // Crea un nuevo mapa y lo centra en la ubicación del usuario
                var map = new google.maps.Map(document.getElementById('map'), {
                    zoom: 12,
                    center: userLocation
                });

                // Coloca un marcador en la ubicación del usuario
                new google.maps.Marker({
                    position: userLocation,
                    map: map,
                    title: 'Tu ubicación'
                });

                // Aquí agregarías los marcadores de las veterinarias
                // usando un bucle y la información de tu backend
            }, function () {
                handleLocationError(true, map.getCenter());
            });
        } else {
            // El navegador no soporta la geolocalización
            handleLocationError(false, map.getCenter());
        }
    }

    function handleLocationError(browserHasGeolocation, pos) {
        // Maneja los errores aquí
    }
</script>

<script>
    new Vue({
        el: '#app',
        data: {
            ubicacionUsuario: null,
            veterinarias: []
        },
        created() {
            this.obtenerUbicacionUsuario();
        },
        methods: {
            obtenerUbicacionUsuario() {
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(this.obtenerVeterinariasCercanas);
                } else {
                    alert("La geolocalización no es soportada por este navegador.");
                }
            },
            obtenerVeterinariasCercanas(position) {
                this.ubicacionUsuario = position.coords;
                // Suponiendo que tienes una función que hace solicitudes HTTP:
                http.get(`/api/veterinarias-cercanas/?lat=${this.ubicacionUsuario.latitude}&lng=${this.ubicacionUsuario.longitude}`)
                    .then(response => {
                        this.veterinarias = response.data;
                        // Aquí inicializarías el mapa con la ubicación actual y agregarías marcadores, por ejemplo.
                    })
                    .catch(error => {
                        console.error("Error al obtener las veterinarias cercanas:", error);
                    });
            }
        }
    });

</script> -->

{% endblock js %}